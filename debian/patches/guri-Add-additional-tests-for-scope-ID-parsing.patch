From: Philip Withnall <pwithnall@endlessos.org>
Date: Mon, 5 Oct 2020 13:52:38 +0100
Subject: guri: Add additional tests for scope ID parsing

These bump up the code coverage.

Signed-off-by: Philip Withnall <pwithnall@endlessos.org>

Origin: upstream, commit:0a3a1360e7efbdf1897c0193f2b42deb5cfc2e1
Applied-Upstream: 2.66.2
---
 glib/tests/uri.c | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/glib/tests/uri.c b/glib/tests/uri.c
index b3843b9..b8a0c6a 100644
--- a/glib/tests/uri.c
+++ b/glib/tests/uri.c
@@ -749,6 +749,14 @@ static const UriAbsoluteTest absolute_tests[] = {
     { NULL, NULL, NULL, -1, NULL, NULL, NULL } },
   { "http://[192.168.0.1%25em1]/", G_URI_FLAGS_NONE, FALSE, G_URI_ERROR_BAD_HOST,
     { NULL, NULL, NULL, -1, NULL, NULL, NULL } },
+  { "http://[fe80::dead:beef%2em1]/", G_URI_FLAGS_PARSE_RELAXED, TRUE, 0,
+    { "http", NULL, "fe80::dead:beef%2em1", -1, "/", NULL, NULL } },
+  { "http://[fe80::dead:beef%2em1]/", G_URI_FLAGS_NONE, FALSE, G_URI_ERROR_BAD_HOST,
+    { NULL, NULL, NULL, -1, NULL, NULL, NULL } },
+  { "http://[fe80::dead:beef%25em1%00]/", G_URI_FLAGS_PARSE_RELAXED, FALSE, G_URI_ERROR_BAD_HOST,
+    { NULL, NULL, NULL, -1, NULL, NULL, NULL } },
+  { "http://[fe80::dead:beef%25em1%00]/", G_URI_FLAGS_NONE, FALSE, G_URI_ERROR_BAD_HOST,
+    { NULL, NULL, NULL, -1, NULL, NULL, NULL } },
 };
 
 static void
